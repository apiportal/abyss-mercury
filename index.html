<!DOCTYPE html>
<html class="vs-index" lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="webroot/frags/layout/head.htm :: header">
<script src="/dist/js/lib/jquery.min.js"></script>
<script src="/dist/js/lib/thymus.min.js" id="thymus"
	data-thx-base-path="." data-thx-frag-extension=".htm"
	data-thx-head-frag="th:include=webroot/frags/layout/head.htm :: header"
	data-thx-preload-js="/dist/js/loader.js"
	data-thx-onfrags="fragsListener();" data-thx-onfrag="fragListener()"></script>
</head>
<body>
<div id="portal" class="wrapper" v-bind:class="pageClass">
	<div th:replace="webroot/frags/layout/navs.htm :: navs"></div>
	<main class="page-wrapper">
	<index inline-template ref="refIndex" v-on:set-state="setState" v-on:set-page="setPage" v-bind:root-state="rootState" v-if="!$root.isLoading">
		<section class="xxx" v-if="!isLoading">
			<transition name="fade">
			<div th:replace="webroot/frags/api/api-preview.htm :: apiPreview"></div>
			</transition>
			<transition name="fade">
			<div th:replace="webroot/frags/api/app-preview.htm :: appPreview"></div>
			</transition>
			<draggable ref="orderedQuestions" v-model="widgets" @update="updateOrder" @clone="clone" :options="widgetOptions" class="fow cards justify-content-center">
				<div :class="c.class" v-for="c in widgets" :key="c.id">
					<component :is="c.comp" :meta="c" :data="c"></component>
				</div>
			</draggable>
		</section>
	</index>
	</main>
</div>

<div class="hide">
	<div id="my-apps-subscriptions">
		<div class="card dash-card-2" v-if="!isLoading">
			<div class="card-title handle bg-cyan txt-white"><h6 class="txt-white d-flex">My APPS & Subscriptions <span class="ml-auto">{{mySubscriptions}}</span></h6></div>
			<div class="fow">
				<div class="fol-sm-6">
					<highcharts :options="mySubscriptionsChart"></highcharts>
				</div>
				<div class="fol-sm-6">
					<div class="card-scroll">
						<div class="my-apps-bar">
							<div v-for="(app, index) in sortByNested(sortApp, $root.appList)" v-if="app.subscriptions" class="brd-b brd-0-last field-controls">
								<a class="nav-link d-block" v-on:click="getMyAppDetail(app,index,true);" :class="{'is-deleted': app.isdeleted}">
									<div class="">										
										<i class="fas fa-check-circle txt-green" title="Active" v-if="!app.isdeleted"></i>
										<i class="fas fa-times-circle txt-red" title="Deleted" v-if="app.isdeleted"></i>
										<strong>{{app.firstname}}</strong>
									</div>
									<div>
										<div class="d-flex txt-uppercase flt-r small txt-muted">
											<span v-if="!app.isdeleted" :title="app.updated | formatDateTime">
												{{app.created | formatDateTime}}
											</span>
											<span class="ml-auto txt-r" v-if="app.isdeleted">
												{{app.deleted | formatDateTime}}
											</span>
										</div>
									</div>
									<code class="d-block txt-line small txt-blue"><small>{{app.uuid}}</small></code>
									<div v-if="app.contracts"><small class="txt-uppercase">Subscriptions:</small> <strong class="txt-black">{{app.subscriptionsCount}}</strong></div>
									<ol class="small pl-3">
										<li v-for="(sub, index) in app.subscriptions">
											<strong>{{sub.apiName}}</strong> by <span>{{sub.apiOwner}}</span>
											<div>{{sub.effectivestartdate | formatDate}} - {{sub.effectiveenddate | formatDate}}</div>
										</li>
									</ol>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="my-business-apis">
		<div class="card dash-card-2" v-if="!isLoading">
			<div class="card-title handle bg-pink txt-white"><h6 class="txt-white d-flex">My Business APIs & Subscribers <span class="ml-auto">{{myBusinessApiList.length}}</span></h6></div>
			<div class="fow">
				<div class="fol-sm-6">
					<highcharts :options="myBusinessApisChart"></highcharts>
				</div>
				<div class="fol-sm-6">
					<div class="card-scroll">
						<div class="my-business-bar">
							<api-list v-for="(api, index) in sortByNested(sortApi, myBusinessApiList)" :api="api" :index="index" :subs="false" :business="true" :key="api.uuid" v-if="api.proxies.length > 0" inline-template>
								<div th:replace="webroot/frags/api/api-preview.htm :: apiDash"></div>
							</api-list>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="my-proxy-apis">
		<div class="card dash-card-2" v-if="!isLoading">
			<div class="card-title handle bg-green txt-white"><h6 class="txt-white d-flex">My Proxy APIs & Subscribers <span class="ml-auto">{{mySubscribersCount}}</span></h6></div>
			<div class="fow">
				<div class="fol-sm-6">
					<highcharts :options="mySubscribersChart"></highcharts>
				</div>
				<div class="fol-sm-6">
					<div class="card-scroll">
						<div class="my-proxy-bar">
							<api-list v-for="(api, index) in sortByNested(sortProxy, myProxyApiList)" :api="api" :index="index" :subs="true" :business="true" :key="api.uuid" inline-template>
								<div th:replace="webroot/frags/api/api-preview.htm :: apiDash"></div>
							</api-list>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="apis-shared-with-me">
		<div class="card dash-card" v-if="!isLoading">
			<div class="card-title handle"><h6>APIs Shared with Me</h6></div>
			<div class="card-scroll">
				<div class="shared-with-bar">
					<api-list v-for="(api, index) in apisSharedWithMe" :api="api" :index="index" :key="api.uuid" v-if="!api.isShareDeleted" :subs="false" :business="false" inline-template>
						<div th:replace="webroot/frags/api/api-preview.htm :: apiDash"></div>
					</api-list>
				</div>
			</div>
		</div>
	</div>
	<div id="apis-shared-by-me">
		<div class="card dash-card" v-if="!isLoading">
			<div class="card-title handle"><h6>APIs Shared by Me</h6></div>
			<div class="card-scroll">
				<div class="shared-by-bar">
					<api-list v-for="(api, index) in apisSharedByMe" :api="api" :index="index" :key="api.uuid" :subs="false" :business="false" v-if="!api.isShareDeleted" inline-template>
						<div th:replace="webroot/frags/api/api-preview.htm :: apiDash"></div>
					</api-list>
				</div>
			</div>
		</div>
	</div>
</div>

<script id="reqVue" data-module="index" data-main="/dist/js/main" src="/dist/js/lib/require.min.js"></script>
</body>
</html>